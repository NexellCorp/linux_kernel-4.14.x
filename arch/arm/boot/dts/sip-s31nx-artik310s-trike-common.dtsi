// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
/*
 * Copyright (C) 2018  Nexell Co., Ltd.
 * Author: JungHyun, Kim <jhkim@nexell.co.kr>
 */

#include <dt-bindings/gpio/gpio.h>
#include "sip-s31nx-artik310s.dtsi"

/ {
	model = "Samsung artik310s trike board based on sip-s31nx";
	compatible = "samsung,artik310s-trike", "samsung,artik310s",
		   "nexell,nxp3220";

	chosen {
		stdout-path = &uart0;
	};

	/* Null codec for PDM reference i2s */
	snd_null_codec0: snd_null_codec@0 {
		#sound-dai-cells = <0>;
		compatible = "nexell,snd-null-codec";
		status = "okay";
	};

	sound0: sound@0 {
		compatible = "simple-audio-card";
		simple-audio-card,name = "Artik310 Audio Card ALC5658";
		simple-audio-card,widgets =
			"Headphone", "Out Jack",
			"Microphone", "In Jack";
		simple-audio-card,routing =
			"IN1P", "MICBIAS1",
			"IN1P", "In Jack",
			"IN1P", "Main Mic";
		status = "okay";

		simple-audio-card,dai-link@0 {
			mclk-fs = <256>;
			format = "i2s";
			frame-master = <&sndcpu0>;
			bitclock-master = <&sndcpu0>;

			sndcpu0: cpu  {
				sound-dai = <&i2s1 0>;
			};

			sndcodec0: codec {
				sound-dai = <&alc5658>;
			};
		};
	};

	sound1: sound@1 {
		compatible = "simple-audio-card";
		simple-audio-card,name = "Artik310 PDM Card";
		status = "okay";

		simple-audio-card,dai-link@0 {
			mclk-fs = <256>;
			format = "i2s";
			frame-master = <&sndcodec1>;
			bitclock-master = <&sndcodec1>;

			sndcpu1: cpu {
				 sound-dai = <&i2s0 0>;
			};

			sndcodec1: codec {
				sound-dai = <&snd_null_codec0>;
			};
		};
	};

	sound-pdm {
		compatible = "nexell,nxp3220-pdm-card";
		snd-controller = <&pdm>;
	};

};

&adc {
	status = "okay";
};

&dwc2otg {
	status = "okay";
};

&dwmmc_2 {
	cap-sd-highspeed;
	cd-gpios = <&gpio_b 24 0>;
	cd-inverted;
	clock-frequency = <200000000>;
	nexell,drive_shift = <0x01>;
	nexell,sample_shift = <0x00>;
	card-detect-delay = <200>;
	disable-wp;
	status = "okay";
};

&ehci {
	status = "okay";
};

&gmac0 {
	status = "okay";

	pinctrl-names = "default";
	pinctrl-0 = <&gmac0_pins>;
	phy-mode = "rgmii";
	phy-handle = <&ethphy0>;
	assigned-clocks = <&cmu CLK_GMAC_RGMII0_AXI>,
			  <&cmu CLK_GMAC_RGMII0_APB>,
			  <&cmu CLK_GMAC_RGMII0_PTP_REF>;
	assigned-clock-rates = <250000000>, <125000000>, <25000000>;

	phy-reset-gpios = <&gpio_d 9 GPIO_ACTIVE_LOW>;
	phy-intr-gpios = <&alive_0 5 GPIO_ACTIVE_LOW>;
	phy-pme-gpios = <&alive_0 2 GPIO_ACTIVE_LOW>;

	mdio@3 {
		#address-cells = <1>;
		#size-cells = <0>;

		ethphy0: ethernet-phy@3 {
			reg = <3>;
		};
	};
};

&gmac0_phyint {
	nexell,pins = "alive-5";
};

&gmac0_pme {
	nexell,pins = "alive-2";
};

&gmac1 {
	status = "okay";

	pinctrl-names = "default";
	pinctrl-0 = <&gmac1_pins>;
	phy-mode = "rmii";
	phy-handle = <&ethphy1>;
	assigned-clocks = <&cmu CLK_GMAC_RMII0_AXI>,
			  <&cmu CLK_GMAC_RMII0_APB>,
			  <&cmu CLK_GMAC_RMII0_PTP_REF>;
	assigned-clock-rates = <250000000>, <125000000>, <25000000>;

	phy-reset-gpios = <&gpio_b 31 GPIO_ACTIVE_LOW>;
	phy-intr-gpios = <&alive_0 7 GPIO_ACTIVE_LOW>;
	phy-pme-gpios = <&alive_0 6 GPIO_ACTIVE_LOW>;

	mdio@1 {
		#address-cells = <1>;
		#size-cells = <0>;

		ethphy1: ethernet-phy@1 {
			reg = <1>;
		};
	};
};

&i2c_1 {
	status = "okay";
	#address-cells = <1>;
	#size-cells = <0>;

	alc5658: alc5658@1a {
		#sound-dai-cells = <0>;
		compatible = "realtek,rt5659";
		reg = <0x1a>;
	};
};

&i2c_2 {
	status = "okay";
	#address-cells = <1>;
	#size-cells = <0>;
};

&i2c_3 {
	status = "okay";
	#address-cells = <1>;
	#size-cells = <0>;
};

&i2c_4 {
	status = "okay";
	#address-cells = <1>;
	#size-cells = <0>;
};

&m_can0 {
	status = "okay";
	assigned-clocks = <&cmu CLK_CAN0_CORE>;
	assigned-clock-rates = <10000000>;
};

&m_can1 {
	status = "okay";
	assigned-clocks = <&cmu CLK_CAN1_CORE>;
	assigned-clock-rates = <10000000>;
};

&mmc2_clk {
	nexell,pin-strength = <NX_PIN_STR1>;
};

&ohci {
	status = "okay";
};

&pdm {
	ref-iis = <0>;
	sample-rate = <16000>;
	assigned-clocks = <&cmu CLK_PDM0_AXI>;
	assigned-clock-rates = <200000000>;
	status = "okay";
};

&pwm {
	status = "okay";
	nexell,pwm-outputs = <0>, <1>, <2>, <3>;
	assigned-clocks = <&cmu CLK_PWM0_APB>;
	assigned-clock-rates = <166000000>;
};

&rtc {
	status = "okay";
};

&spi_1 {
	status = "okay";
	assigned-clocks = <&cmu CLK_SPI1_APB>, <&cmu CLK_SPI1_CORE>;
	assigned-clock-rates = <200000000>, <200000000>;
	cs-gpios = <&gpio_a 9 0>;

	spidev@0 {
		compatible = "linux,spidev";
		reg = <0>;
		spi-max-frequency = <20000000>;
	};
};

&spi_2 {
	status = "okay";
	assigned-clocks = <&cmu CLK_SPI2_APB>, <&cmu CLK_SPI2_CORE>;
	assigned-clock-rates = <200000000>, <200000000>;
	cs-gpios = <&gpio_a 13 0>;

	spidev@0 {
		compatible = "linux,spidev";
		reg = <0>;
		spi-max-frequency = <20000000>;
	};
};

&uart0 {
	status = "okay";
};

&uart1 {
	status = "okay";
};

&uart3 {
	status = "okay";
};

&uart4 {
	status = "okay";
	pinctrl-0 = <&uart4_bus &uart4_485>;
	linux,rs485-enabled-at-boot-time;
	rs485-rts-active-low;
};

&uart5 {
	status = "okay";
	pinctrl-0 = <&uart5_bus &uart5_485>;
	linux,rs485-enabled-at-boot-time;
	rs485-rts-active-low;
};

&usb2phy {
	status = "okay";
	otg,vbus-gpio = <&gpio_c 12 0>;
	otg,vbus-tune = <1>;
	ehci,vbus-gpio = <&gpio_b 23 0>;
};

&i2s0_bus {
	nexell,pin-pull = <NX_PIN_PULL_UP>;
};

&i2s0 {
	frame-bit = <32>;
	sample-rate = <48000>;
	status = "okay";
};

&i2s1 {
	frame-bit = <32>;
	sample-rate = <48000>;
	assigned-clock-rates = <12288000>;
	status = "okay";
};
